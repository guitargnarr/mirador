[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info

[program:ollama]
command=/bin/ollama serve
autostart=true
autorestart=true
startretries=3
stdout_logfile=/app/logs/ollama.log
stderr_logfile=/app/logs/ollama_error.log
priority=1

[program:mirador]
command=/usr/bin/python3 /app/mirador_server.py
autostart=true
autorestart=true
startretries=3
stdout_logfile=/app/logs/mirador.log
stderr_logfile=/app/logs/mirador_error.log
priority=2
startsecs=15
depends_on=ollama

[program:model-preload]
command=/bin/bash -c "sleep 10 && ollama run phi3:mini test"
autostart=true
autorestart=false
startretries=1
stdout_logfile=/app/logs/preload.log
stderr_logfile=/app/logs/preload_error.log
priority=3
